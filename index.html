<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!--meta name="viewport" content="width=device-width, initial-scale=1.0"-->
    <meta content="scale generator,chord generator,music,scales,scales,chord,chords,note,notes,mode,modes,harmonization,guitar,fretboard,keyboard" name=keywords>
    <title>Music Companion</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="img/G_clef.png">
    <link rel="icon" href="img/G_clef.png">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/notes.js"></script>
    <script src="js/intervals.js"></script>
    <script src="js/scales.js"></script>
    <script src="js/chords.js"></script>
    <script src="js/roman.js"></script>
    <script src="js/array_tools.js"></script>
    <script src="js/scale_explorer.js"></script>
    <script src="js/fretboard.js"></script>
    <script src="js/keyboard.js"></script>
    <script src="js/scale_finder.js"></script>
    <script src="js/chord_finder.js"></script>
    <script src="js/chord_generator.js"></script>
    <script src="js/url_parameters.js"></script>
    <script src="js/interface.js"></script>

    <!-- //////////////////////////////// MIDI //////////////////////////// -->

    <!-- shims -->
    <script src="js/midi/Base64.js" type="text/javascript"></script>
    <script src="js/midi/Base64binary.js" type="text/javascript"></script>
    <script src="js/midi/WebAudioAPI.js" type="text/javascript"></script>
    <!-- midi.js -->
    <script src="js/midi/audioDetect.js" type="text/javascript"></script>
    <script src="js/midi/gm.js" type="text/javascript"></script>
    <script src="js/midi/loader.js" type="text/javascript"></script>
    <script src="js/midi/plugin.audiotag.js" type="text/javascript"></script>
    <script src="js/midi/plugin.webaudio.js" type="text/javascript"></script>
    <script src="js/midi/plugin.webmidi.js" type="text/javascript"></script>
    <!-- utils -->
    <script src="js/midi/dom_request_xhr.js" type="text/javascript"></script>
    <script src="js/midi/dom_request_script.js" type="text/javascript"></script>
    <!-- soundfonts -->
    <script src="js/midi/soundfonts/acoustic_grand_piano-ogg.js" type="text/javascript"></script>
    
    <script src="js/functions_play.js" type="text/javascript"></script>
    <script src="js/strings.js" type="text/javascript"></script>
  </head>
  <body onresize="onResize()">
    
    <h3>
      <table style='width: 100%;text-align: center;'>
        <tr>
          <td>
            <span style='float: left;'>
              <a href="https://github.com/Modrigue/WebMusicScaleGenerator" target="_blank"><img src="img/GitHub-Mark-24px.png" alt="GitHub"/></a>
              <!--a href="mailto:nicolas.gourier+musiccompanion@gmail.com" target="_blank"><img src="img/mail.png" alt="Mail"/></a-->
              &nbsp;&nbsp;&nbsp;
            </span>
          </td>
          <td><button class="button-page" id="button_page_chord_explorer" onclick='selectPage("page_chord_explorer")'>Find chords</button></td>
          <td><button class="button-page" id="button_page_scale_explorer" onclick='selectPage("page_scale_explorer")'>Explore scales</button></td>
          <td><button class="button-page" id="button_page_scale_finder" onclick='selectPage("page_scale_finder")'>Find scales</button></td>
          <td>
            <span style='float: right;'>
              <input type="checkbox" id="checkboxLanguage" name="checkboxLanguage" onchange="updateLocales()">
              <label class="input-label" for="checkboxLanguage"><img src="img/french_flag.png" alt="FR"/></label>
            </span>
          </td>
      </table>
    </h3>

    <br>

    <!--------------------------------- WELCOME ------------------------------>

    <div id="page_welcome">
      <center>
        <br><br>
        <h2 id="welcome_title">Welcome</h2>
        <h3 id="welcome_subtitle" style="font-size: 18px;">What do want to do?</h3>
        <br><br><br><br><br><br>
      </center>
    </div>
  
    <!---------------------------- SCALES EXPLORER --------------------------->

    <div id="page_scale_explorer">
    <center>
      <p style="font-family:Arial, Helvetica, sans-serif;">
      <span id="select_key_text">Select your key:</span>

      <!-- NOTES -->
      <select name="notes" id="note" onchange="onNoteChanged()">
      </select>

      <!-- SCALES / MODES -->
      <select name="scales" id="scale" onchange="onScaleChanged()">
      </select>

      <!-- Checkboxes -->

      <!--input type="checkbox" id="checkboxNotes" name="checkboxNotes" checked onchange="toggleDisplay('scale_result')">
      <label class="input-label" for="checkboxNotes">Notes</label>
      
      <input type="checkbox" id="checkboxChords3" name="checkboxChords3" checked onchange="toggleDisplay('chords3_result')">
      <label class="input-label" for="checkboxChords3">3-Chords</label>

      <input type="checkbox" id="checkboxChords4" name="checkboxChords4" checked onchange="toggleDisplay('chords4_result')">
      <label class="input-label" for="checkboxChords4">4-Chords</label-->

      <input type="checkbox" id="checkboxChords" name="checkboxChords" checked onchange="toggleDisplay('chords3_result');toggleDisplay('chords4_result');">
      <label class="input-label" id="checkboxChordsLabel" for="checkboxChords">Chords</label>

      <input type="checkbox" id="checkboxGuitar" name="checkboxGuitar" checked onchange="toggleDisplay('canvas_guitar')">
      <label class="input-label" id="checkboxGuitarLabel" for="checkboxGuitar">Guitar</label>

      <input type="checkbox" id="checkboxKeyboard" name="checkboxKeyboard" checked onchange="toggleDisplay('canvas_keyboard')">
      <label class="input-label" id="checkboxKeyboardLabel" for="checkboxKeyboard">Keyboard</label>

    </p>
    </center>

    <p id='scale_result'>?</p>
    
    <p id='chords3_result'>?</p>
    
    <p id='chords4_result'>?</p>

    <canvas id="canvas_guitar" width="600" height="200" onclick="saveFretboardImage()">
      Your browser does not support the canvas element.
    </canvas>

    <canvas id="canvas_keyboard" width="600" height="200">
      Your browser does not support the canvas element.
    </canvas>
    
  </div>

  <!------------------------------ SCALES FINDER ----------------------------->

  <div id ='page_scale_finder'>
    <center>
      <p><span id="header_scale_finder">Select your notes and chords:</span></p>

      <select name="notes_finder1" id="note_finder1" onchange="update()"></select>
      <select name="chords_finder1" id="chord_finder1" onchange="update()"></select>
      &nbsp;&nbsp;
      <select name="notes_finder2" id="note_finder2" onchange="update()"></select>
      <select name="chords_finder2" id="chord_finder2" onchange="update()"></select>
      &nbsp;&nbsp;
      <select name="notes_finder3" id="note_finder3" onchange="update()"></select>
      <select name="chords_finder3" id="chord_finder3" onchange="update()"></select>
      &nbsp;&nbsp;
      <select name="notes_finder4" id="note_finder4" onchange="update()"></select>
      <select name="chords_finder4" id="chord_finder4" onchange="update()"></select>
      <br><br>
      <select name="notes_finder5" id="note_finder5" onchange="update()"></select>
      <select name="chords_finder5" id="chord_finder5" onchange="update()"></select>
      &nbsp;&nbsp;
      <select name="notes_finder6" id="note_finder6" onchange="update()"></select>
      <select name="chords_finder6" id="chord_finder6" onchange="update()"></select>
      &nbsp;&nbsp;
      <select name="notes_finder7" id="note_finder7" onchange="update()"></select>
      <select name="chords_finder7" id="chord_finder7" onchange="update()"></select>
      &nbsp;&nbsp;
      <select name="notes_finder8" id="note_finder8" onchange="update()"></select>
      <select name="chords_finder8" id="chord_finder8" onchange="update()"></select>

      <p>
        <span class="scale_finder_found_notes" id="scale_finder_found_notes_text"></span>
      </p>

      <p>
        <span class="tonic">Tonic:</span>
        <select name="notes_finder_tonic" id="note_finder_tonic" onchange="update()"></select>
        &nbsp;&nbsp;
        <button id="reset_scale_finder" onclick='resetScaleFinder()'><span class="reset">Reset</span></button>
      </p>
    </center>
  </div>

  <!----------------------------- RELATIVE SCALES ---------------------------->

  <div id='section_found_scales'>
    <p id='found_scales'></p>
  </div>

  <!------------------------- FOUND CHORDS FROM SCALE ------------------------>

  <div id='section_found_chords_from_scale'>
  </div>

  <!----------------------------- CHORDS EXPLORER ---------------------------->

  <div id ='page_chord_explorer'>
    <div>
      <input type="radio"  id="radioChordExplorerName" name="chord_explorer_mode" value="name" checked onchange="update()"></input>
      <label class="input-label" id="radioChordExplorerNameLabel" for="radioChordExplorerName">Name:</label>
      <select name="notes_explorer_chord" id="note_explorer_chord" onchange="update()"></select>
      <select name="chords_explorer_chord" id="chord_explorer_chord" onchange="update()"></select>
      <span class="chord_explorer_arpeggio" id="chord_explorer_arpeggio_texts" span style='float: right;'>
        <span id="chord_explorer_arpeggio_notes">?</span>
        &nbsp;/&nbsp;
        <span id="chord_explorer_arpeggio_intervals">?</span>
      </span>
    </div>

    <div>
      <input type="radio" id="radioChordExplorerNotes" name="chord_explorer_mode" value="notes" onchange="update()">
      <label class="input-label" id="radioChordExplorerNotesLabel" for="radioChordExplorerNotes">Notes:</label>
      <select name="chord_explorer_note1" id="chord_explorer_note1" disabled onchange="update()"></select>
      <select name="chord_explorer_note2" id="chord_explorer_note2" disabled onchange="update()"></select>
      <select name="chord_explorer_note3" id="chord_explorer_note3" disabled onchange="update()"></select>
      <select name="chord_explorer_note4" id="chord_explorer_note4" disabled onchange="update()"></select>
      <select name="chord_explorer_note5" id="chord_explorer_note5" disabled onchange="update()"></select>
      <select name="chord_explorer_note6" id="chord_explorer_note6" disabled onchange="update()"></select>
      <span class="chord_explorer_found_chords" id="chord_explorer_found_chords_texts" span style='float: right;'></span>
    </div>

    <br>
    <div id='options_chord_explorer'>
      <span style='float: center;'>
        <button id="play_found_chord">Play ♪</button>
        <button id="play_found_arpeggio">Play arpeggio ♪</button>
      </span>
      <span style='float: right;'>
        <input type="checkbox" id="checkboxBarres" name="checkboxBarres" checked onchange="update()">
        <label class="input-label" id="checkboxBarresLabel" for="checkboxBarres">Barres</label>
      
        <select name="chord_explorer_nb_strings" id="chord_explorer_nb_strings" onchange="update()">
          <option value=99 id="chord_explorer_nb_strings_option_max">Max</option>
          <option value=6 id="chord_explorer_nb_strings_option_6">6</option>
          <option value=5 id="chord_explorer_nb_strings_option_5">5</option>
          <option value=4 id="chord_explorer_nb_strings_option_4">4</option>
          <option value=3 id="chord_explorer_nb_strings_option_3">3</option>
          <option value=2 id="chord_explorer_nb_strings_option_2">2</option>
          <option value=0 id="chord_explorer_nb_strings_option_min">Min</option>
        </select>
        <span id="chord_explorer_nb_strings_text">strings played</span>
      </span>
    </div>

    <br>
    <div id='section_guitar_chords'>
      <p id='generated_guitar_chords' style="text-align: center;">?</p>
    </div>
  </div>

    <script>
      // init
      initLanguage();
      updateSelectors();
      onResize();
      initPagefromURLParams();

      // test chord positions finder algorithms
      //testGenerateChordPositions();
      //testChordPositionsLog();

      // init MIDI plugins
      window.onload = function ()
      {
        MIDI.loadPlugin(
        {
          soundfontUrl: "./soundfont/",
          instrument: "acoustic_grand_piano",
          onprogress: function(state, progress)
          {
            //console.log(state, progress);
          },
          onsuccess: function()
          {
            //
          }
        });
      };

    </script>

    <br>
    <footer>Copyright &copy; 2020 <a href="mailto:nicolas.gourier+musiccompanion@gmail.com">Nico</a></footer>
  </body>
</html>